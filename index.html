<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Pixel Count Arcade</title>

<style>
    body {
        margin: 0;
        background: #000;
        overflow: hidden;
        font-family: "Courier New", monospace;
        user-select: none;
    }

    /* ---------------- HUD + TITLE ---------------- */
    #title {
        position: fixed;
        top: 5px;
        left: 50%;
        transform: translateX(-50%);
        color: #ffea00;
        font-size: 48px;
        font-weight: bold;
        text-shadow: 
            0 0 12px #ffea00,
            0 0 25px #ffaa00,
            0 0 40px #ff4400,
            0 0 70px #ff1100;
        z-index: 2000;
        animation: marqueePulse 2s infinite alternate;
    }

    @keyframes marqueePulse {
        from { text-shadow: 0 0 15px #ffea00, 0 0 60px #ff4400; }
        to   { text-shadow: 0 0 30px #ffee55, 0 0 100px #ff2200; }
    }

    #hud {
        position: fixed;
        top: 75px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 10px;
        z-index: 2000;
    }

    button {
        padding: 12px 24px;
        font-size: 22px;
        border-radius: 6px;
        cursor: pointer;
        font-weight: bold;
        border: 3px solid #00eaff;
        background: #111;
        color: white;
        text-shadow: 0 0 6px #00eaff;
    }

    #startBtn:hover, #resetBtn:hover {
        background: #333;
    }

    /* ---------------- TARGET NUMBER ---------------- */
    #topBox {
        position: fixed;
        top: 150px;
        left: 50%;
        transform: translateX(-50%);
        text-align: center;
        display: none;
        z-index: 2000;
    }

    #targetNumber {
        padding: 15px 25px;
        background: #222;
        border: 4px solid #00ff88;
        border-radius: 10px;
        font-size: 42px;
        color: #00ff88;
        text-shadow: 0 0 10px #00ff88;
        box-shadow: 0 0 20px #00ff88;
    }

    #instruction {
        color: #ccffcc;
        margin-top: 8px;
        font-size: 20px;
    }

    /* ---------------- FULLSCREEN GAME AREA ---------------- */
    #gameArea {
        position: fixed;
        inset: 0;
        overflow: hidden;
        z-index: 1;
        background: transparent;
    }

    /* ---------------- BORDER ANIMATION ---------------- */
    #borderLine {
        position: fixed;
        border: 4px solid #00ff88;
        box-shadow: 0 0 12px #00ff88, 0 0 30px #00ffaa;
        display: none;
        z-index: 1500;
        pointer-events: none;
    }

    /* ---------------- GO TIME ---------------- */
    #goTime {
        display: none;
        position: fixed;
        top: 45%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #00ff88;
        font-size: 72px;
        font-weight: bold;
        text-shadow: 0 0 20px #00ff88, 0 0 40px #00ffaa;
        z-index: 1500;
    }

    /* ---------------- STOP + SPEED UP BUTTONS ---------------- */
    #stopBtnArcade {
        display: none;
        position: fixed;
        top: 45%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: #ff0033;
        border: 4px solid #ff6666;
        color: #fff;
        padding: 26px 44px;
        font-size: 40px;
        font-weight: bold;
        border-radius: 14px;
        text-shadow: 0 0 10px #fff;
        box-shadow: 0 0 20px #ff0000, 0 0 60px #ff3333;
        z-index: 2000;
    }

    #speedBtnArcade {
        display: none;
        position: fixed;
        top: 58%;
        left: 50%;
        transform: translateX(-50%);
        background: #0088ff;
        border: 3px solid #44ccff;
        padding: 16px 36px;
        color: white;
        font-size: 24px;
        border-radius: 10px;
        text-shadow: 0 0 6px #ffffff;
        box-shadow: 0 0 15px #0088ff;
        z-index: 2000;
    }

    /* ---------------- 10X FLASH ---------------- */
    #tenXFlash {
        display: none;
        position: fixed;
        top: 48%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #ff0000;
        font-size: 120px;
        font-weight: bold;
        text-shadow: 0 0 40px #ff0000, 0 0 80px #ff0000;
        animation: flash 0.8s infinite alternate;
        z-index: 3000;
    }

    @keyframes flash {
        from { opacity: 1; }
        to { opacity: 0.3; }
    }

    /* ---------------- RESULTS BOX ---------------- */
    #finalNumber {
        display: none;
        position: fixed;
        top: 33%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 120px;
        font-weight: bold;
        color: #ffee55;
        text-shadow: 0 0 20px #ffee55, 0 0 50px #ffaa00;
        z-index: 2000;
    }

    #resultBox {
        display: none;
        position: fixed;
        top: 58%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(255,255,255,0.95);
        color: #000;
        padding: 20px 35px;
        font-size: 26px;
        border-radius: 14px;
        border: 3px solid #000;
        max-width: 80vw;
        text-align: center;
        z-index: 2000;
    }
</style>
</head>
<body>

<!-- TOP HUD TITLE -->
<div id="title">PIXEL COUNT</div>

<!-- HUD BUTTONS -->
<div id="hud">
    <button id="startBtn">START</button>
    <button id="resetBtn">RESET</button>
</div>

<!-- TARGET BOX -->
<div id="topBox">
    <div id="targetNumber"></div>
    <div id="instruction">Stop at this number</div>
</div>

<!-- FULLSCREEN GAME AREA -->
<div id="gameArea"></div>

<!-- Border Animation -->
<div id="borderLine"></div>

<!-- GO TIME -->
<div id="goTime">GO TIME!</div>

<!-- STOP & SPEED BUTTONS -->
<button id="stopBtnArcade">STOP</button>
<button id="speedBtnArcade">↑↑ SPEED UP ↑↑</button>

<!-- FLASH -->
<div id="tenXFlash">10X</div>

<!-- FINAL CLEAR RESULTS -->
<div id="finalNumber"></div>
<div id="resultBox"></div>

<script>
/* ---------------- VARIABLES ---------------- */
let gameRunning = false;
let pixelCount = 0;
let spawnRate = 1000;
let targetNumber;
let spawnInterval;
let speedInterval;
let usingCanvas = false;
let canvas, ctx;

const thresholdForCanvas = 2500;

/* ---------------- FUNNY PHRASES ---------------- */
const phrases = [
    "You were lightyears off… but astronauts miss too.",
    "Close enough for government work.",
    "You tried. Gold star for effort.",
    "Close-ish. Like darts in the dark.",
    "You overshot that like my uncle at a buffet.",
    "I've seen closer guesses from a Magic 8 Ball.",
    "Respectfully… wow.",
    "Hilariously inaccurate. Try again.",
    "You almost broke math with that one.",
    "Somewhere, a calculator is crying.",
    "You were close! In a parallel universe.",
    "You missed like a stormtrooper.",
    "Nearly nailed it. Nearly.",
    "You grazed the galaxy of correctness.",
    "Not bad. Not good either.",
    "You got spirit. Accuracy? No.",
    "That was… something.",
    "Your guess had emotional value.",
    "That was boldly incorrect.",
    "You swung hard and missed harder.",
    "Close as my bank account to millionaire status.",
    "A for effort. F for accuracy.",
    "A cosmic miss, my friend.",
    "Statistically improbable. Impressive.",
    "That was brave.",
    "You're consistent… consistently off.",
    "So close the pixels giggled.",
    "Not bad! Actually… kinda bad.",
    "Your intuition needs new batteries.",
    "Pixel gods say: try harder.",
    "Respectfully: yikes.",
    "A noble attempt!",
    "Your guess was a plot twist.",
    "A valiant fail.",
    "You aimed for glory, hit potato.",
    "Your strategy was… unique.",
    "In the ballpark of a different sport.",
    "You confused accuracy with enthusiasm.",
    "Beautiful effort. Chaotic results.",
    "That was almost art."
];

/* ---------------- HYBRID PIXEL ENGINE ---------------- */
function setupCanvas() {
    canvas = document.createElement("canvas");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    canvas.style.position = "fixed";
    canvas.style.inset = "0";
    canvas.style.zIndex = "1";
    canvas.style.pointerEvents = "none";
    ctx = canvas.getContext("2d");
    document.body.appendChild(canvas);
    usingCanvas = true;
}

function drawCanvasPixel() {
    const x = Math.random() * canvas.width;
    const y = Math.random() * canvas.height;

    ctx.fillStyle = `rgba(${Math.floor(Math.random()*255)}, 
                          ${Math.floor(Math.random()*255)}, 
                          ${Math.floor(Math.random()*255)}, 
                          0.9)`;
    ctx.shadowColor = ctx.fillStyle;
    ctx.shadowBlur = 8;
    ctx.beginPath();
    ctx.rect(x, y, 10, 10);
    ctx.fill();
}

/* ---------------- DOM PIXEL MODE ---------------- */
function spawnDomPixel() {
    if (!gameRunning) return;

    if (pixelCount > thresholdForCanvas && !usingCanvas) {
        switchToCanvas();
        return;
    }

    const p = document.createElement("div");
    p.className = "pixel";
    p.style.background = `#${Math.floor(Math.random()*0xffffff).toString(16)}`;
    p.style.left = Math.random() * (window.innerWidth-20) + "px";
    p.style.top = Math.random() * (window.innerHeight-20) + "px";
    p.style.boxShadow = `0 0 10px ${p.style.background}`;
    document.getElementById("gameArea").appendChild(p);

    pixelCount++;
}

function switchToCanvas() {
    setupCanvas();
    document.getElementById("gameArea").innerHTML = "";
}

function spawnPixel() {
    if (!gameRunning) return;

    if (usingCanvas) return drawCanvasPixel();
    spawnDomPixel();
}

/* ---------------- BORDER ANIMATION ---------------- */
function animateBorder(callback) {
    const line = document.getElementById("borderLine");
    line.style.display = "block";

    const W = window.innerWidth;
    const H = window.innerHeight;

    let stage = 0, p = 0;

    const anim = setInterval(() => {
        p += 20;

        if (stage === 0) {
            line.style.left = "0px";
            line.style.top = "0px";
            line.style.width = p + "px";
            line.style.height = "0px";
            if (p >= W) stage=1,p=0;
        } else if (stage === 1) {
            line.style.width = W+"px";
            line.style.height = p+"px";
            if (p >= H) stage=2,p=0;
        } else if (stage === 2) {
            line.style.left = p+"px";
            line.style.width = (W-p)+"px";
            if (p >= W) stage=3,p=0;
        } else if (stage === 3) {
            line.style.top = p+"px";
            line.style.height = (H-p)+"px";
            if (p >= H) {
                clearInterval(anim);
                line.style.display="none";
                document.getElementById("goTime").style.display="block";
                setTimeout(()=>{
                    document.getElementById("goTime").style.display="none";
                    callback();
                },900);
            }
        }
    },10);
}

/* ---------------- START ---------------- */
document.getElementById("startBtn").onclick = () => {
    if (gameRunning) return;

    gameRunning = true;
    pixelCount = 0;
    spawnRate = 1000;
    usingCanvas = false;
    document.getElementById("gameArea").innerHTML = "";
    if (canvas) canvas.remove();

    targetNumber = Math.floor(Math.random()*3630)+69;
    document.getElementById("topBox").style.display="block";
    document.getElementById("targetNumber").innerText = targetNumber;
    document.getElementById("stopBtnArcade").style.display="none";
    document.getElementById("speedBtnArcade").style.display="none";

    animateBorder(()=>{
        document.getElementById("stopBtnArcade").style.display="block";
        document.getElementById("speedBtnArcade").style.display="block";
        spawnInterval = setInterval(spawnPixel, spawnRate);
        speedInterval = setInterval(()=>speedUpPixels(false),3000);
    });
};

/* ---------------- SPEED UP ---------------- */
function speedUpPixels(fromButton) {
    spawnRate = Math.max(3, spawnRate/10);
    clearInterval(spawnInterval);
    spawnInterval = setInterval(spawnPixel, spawnRate);

    if (fromButton) {
        const flash = document.getElementById("tenXFlash");
        flash.style.display = "block";
        setTimeout(()=>flash.style.display="none",3000);
    }
}

document.getElementById("speedBtnArcade").onclick = () => {
    if (!gameRunning) return;
    speedUpPixels(true);
};

/* ---------------- STOP ---------------- */
document.getElementById("stopBtnArcade").onclick = () => {
    if (!gameRunning) return;

    gameRunning = false;
    clearInterval(spawnInterval);
    clearInterval(speedInterval);

    document.getElementById("stopBtnArcade").style.display="none";
    document.getElementById("speedBtnArcade").style.display="none";

    const finalNumber = document.getElementById("finalNumber");
    finalNumber.innerText = pixelCount;
    finalNumber.style.display = "block";

    const diff = Math.abs(pixelCount - targetNumber);
    const phrase = phrases[Math.floor(Math.random()*phrases.length)];
    const resultBox = document.getElementById("resultBox");
    resultBox.innerText = `${phrase}\nYou were ${diff} numbers away.`;
    resultBox.style.display = "block";
};

/* ---------------- RESET ---------------- */
document.getElementById("resetBtn").onclick = () => {
    gameRunning = false;

    clearInterval(spawnInterval);
    clearInterval(speedInterval);

    pixelCount = 0;
    document.getElementById("finalNumber").style.display="none";
    document.getElementById("resultBox").style.display="none";
    document.getElementById("topBox").style.display="none";
    document.getElementById("stopBtnArcade").style.display="none";
    document.getElementById("speedBtnArcade").style.display="none";

    document.getElementById("gameArea").innerHTML="";
    if (canvas) {
        canvas.remove();
        usingCanvas=false;
    }
};
</script>

</body>
</html>
